<%- include('partials/header') %>

<a href="/dashboard" style="text-decoration: none; color: #3498db;">&larr; <%= t('classes.backToDashboard') %></a>

<div class="card" style="margin-top: 1rem;">
  <h1><%= classData.code %>: <%= classData.name %></h1>
  <p style="color: #666; margin-top: 0.5rem;"><%= classData.description %></p>
  <div style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid #e0e0e0;">
    <strong><%= t('classes.semester') %>:</strong> <%= classData.semester %> &nbsp;|&nbsp;
    <strong><%= t('classes.professor') %>:</strong> <%= classData.professor_name || t('classes.tba') %>
  </div>
</div>

<div class="card">
  <h2><%= t('classes.courseSessions') %></h2>
  <table>
    <thead>
      <tr>
        <th style="width: 80px;"><%= t('classes.sessionNumber') %></th>
        <th><%= t('classes.title') %></th>
        <th><%= t('classes.date') %></th>
        <th style="width: 150px;"><%= t('common.actions') %></th>
      </tr>
    </thead>
    <tbody>
      <% sessions.forEach(session => { %>
        <tr>
          <td><strong>#<%= session.session_number %></strong></td>
          <td><%= session.title %></td>
          <td><%= session.date || t('classes.tba') %></td>
          <td>
            <a href="/sessions/<%= session.id %>" class="btn btn-primary" style="font-size: 0.85rem; padding: 0.4rem 0.8rem;">
              <%= t('common.view') %>
            </a>
            <% if (canEdit) { %>
              <a href="/sessions/<%= session.id %>/edit" class="btn btn-secondary" style="font-size: 0.85rem; padding: 0.4rem 0.8rem;">
                <%= t('common.edit') %>
              </a>
            <% } %>
          </td>
        </tr>
      <% }); %>
    </tbody>
  </table>
</div>

<% if (user.role === 'professor' || user.role === 'admin') { %>
  <div class="card">
    <h2><%= t('classes.enrolledStudents') %> (<%= enrolledStudents.length %>)</h2>
    <% if (enrolledStudents.length === 0) { %>
      <p style="color: #999;"><%= t('classes.noStudentsEnrolled') %></p>
    <% } else { %>
      <table>
        <thead>
          <tr>
            <th><%= t('classes.username') %></th>
            <th><%= t('classes.email') %></th>
            <th><%= t('dashboard.student.grade') %></th>
          </tr>
        </thead>
        <tbody>
          <% enrolledStudents.forEach(student => { %>
            <tr>
              <td><%= student.username %></td>
              <td><%= student.email %></td>
              <td><%= student.grade || t('dashboard.student.inProgress') %></td>
            </tr>
          <% }); %>
        </tbody>
      </table>
    <% } %>
  </div>
<% } %>

<%- include('partials/footer') %>
